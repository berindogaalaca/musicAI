<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="../css/output.css" rel="stylesheet" />

    <title>Profile</title>
  </head>
  <body class="bg-[#161616] min-h-screen text-white p-6">
    <header class="mt-3 w-full">
      <div class="flex items-center relative mb-4">
        <button
          class="p-4 bg-[#262626] absolute left-0 rounded-2xl"
          onclick="history.back()"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9.99998 13.28L5.65331 8.93333C5.13998 8.42 5.13998 7.58 5.65331 7.06667L9.99998 2.72"
              stroke="white"
              stroke-width="1.5"
              stroke-miterlimit="10"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
        <div class="flex items-center justify-center gap-2 w-full">
          <h2>Profil</h2>
        </div>
      </div>
    </header>

    <div
      id="profile"
      class="flex items-center justify-center w-full mt-3 text-[22px] font-medium"
    >
      <span>Profilini DÃ¼zenle ðŸ‘¤ </span>
    </div>
    <div
      id="profile-image"
      class="flex items-center justify-center w-full mt-7"
    >
      <div class="relative w-20 h-20">
        <img
          class="w-full object-cover rounded-full"
          id="avatar-img"
          src="../assets/image/avatar.webp"
          alt="avatar image"
        />
        <button
          class="absolute -bottom-2 right-0 bg-white p-1 rounded-full shadow-lg"
          id="change-avatar-btn"
        >
          <svg
            width="19"
            height="18"
            viewBox="0 0 19 18"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14 5.25H12.5L12.0065 3.76941C11.8535 3.30966 11.4237 3 10.9392 3H8.06079C7.57629 3 7.14647 3.30966 6.99347 3.76941L6.5 5.25H5C3.5 5.25 2.75 6 2.75 7.5V13.5C2.75 15 3.5 15.75 5 15.75H14C15.5 15.75 16.25 15 16.25 13.5V7.5C16.25 6 15.5 5.25 14 5.25ZM9.5 12.75C8.25725 12.75 7.25 11.7428 7.25 10.5C7.25 9.25725 8.25725 8.25 9.5 8.25C10.7428 8.25 11.75 9.25725 11.75 10.5C11.75 11.7428 10.7428 12.75 9.5 12.75ZM13.625 8.625C13.211 8.625 12.875 8.289 12.875 7.875C12.875 7.461 13.211 7.125 13.625 7.125C14.039 7.125 14.375 7.461 14.375 7.875C14.375 8.289 14.039 8.625 13.625 8.625Z"
              fill="#3C3C43"
              fill-opacity="0.6"
            />
          </svg>
        </button>
        <input
          type="file"
          id="avatar-input"
          accept="image/*"
          style="display: none"
        />
      </div>
    </div>
    <div id="motion-div" class="max-w-md mx-auto space-y-4 mt-7">
      <div
        id="motion-input"
        class="flex items-center bg-[#262626] rounded-xl p-4"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z"
            stroke="white"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M20.59 22C20.59 18.13 16.74 15 12 15C7.26003 15 3.41003 18.13 3.41003 22"
            stroke="white"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <input
          type="text"
          id="fullName"
          class="ml-4 text-[15px] bg-transparent focus:outline-none w-full"
          placeholder="Ad Soyad"
        />
      </div>

      <div
        id="motion-input"
        class="flex items-center bg-[#262626] rounded-xl p-4"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M21.97 18.33C21.97 18.69 21.89 19.06 21.72 19.42C21.55 19.78 21.33 20.12 21.04 20.44C20.55 20.98 20.01 21.37 19.4 21.62C18.8 21.87 18.15 22 17.45 22C16.43 22 15.34 21.76 14.19 21.27C13.04 20.78 11.89 20.12 10.75 19.29C9.6 18.45 8.51 17.52 7.47 16.49C6.44 15.45 5.51 14.36 4.68 13.22C3.86 12.08 3.2 10.94 2.72 9.81C2.24 8.67 2 7.58 2 6.54C2 5.86 2.12 5.21 2.36 4.61C2.6 4 2.98 3.44 3.51 2.94C4.15 2.31 4.85 2 5.59 2C5.87 2 6.15 2.06 6.4 2.18C6.66 2.3 6.89 2.48 7.07 2.74L9.39 6.01C9.57 6.26 9.7 6.49 9.79 6.71C9.88 6.92 9.93 7.13 9.93 7.32C9.93 7.56 9.86 7.8 9.72 8.03C9.59 8.26 9.4 8.5 9.16 8.74L8.4 9.53C8.29 9.64 8.24 9.77 8.24 9.93C8.24 10.01 8.25 10.08 8.27 10.16C8.3 10.24 8.33 10.3 8.35 10.36C8.53 10.69 8.84 11.12 9.28 11.64C9.73 12.16 10.21 12.69 10.73 13.22C11.27 13.75 11.79 14.24 12.32 14.69C12.84 15.13 13.27 15.43 13.61 15.61C13.66 15.63 13.72 15.66 13.79 15.69C13.87 15.72 13.95 15.73 14.04 15.73C14.21 15.73 14.34 15.67 14.45 15.56L15.21 14.81C15.46 14.56 15.7 14.37 15.93 14.25C16.16 14.11 16.39 14.04 16.64 14.04C16.83 14.04 17.03 14.08 17.25 14.17C17.47 14.26 17.7 14.39 17.95 14.56L21.26 16.91C21.52 17.09 21.7 17.3 21.81 17.55C21.91 17.8 21.97 18.05 21.97 18.33Z"
            stroke="white"
            stroke-width="1.5"
            stroke-miterlimit="10"
          />
        </svg>

        <input
          type="tel"
          id="phone"
          class="ml-4 text-[15px] bg-transparent focus:outline-none w-full"
          placeholder="Telefon NumarasÄ±"
        />
      </div>

      <div
        id="motion-input"
        class="flex items-center bg-[#262626] rounded-xl p-4"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M17 20.5H7C4 20.5 2 19 2 15.5V8.5C2 5 4 3.5 7 3.5H17C20 3.5 22 5 22 8.5V15.5C22 19 20 20.5 17 20.5Z"
            stroke="white"
            stroke-width="1.5"
            stroke-miterlimit="10"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M17 9L13.87 11.5C12.84 12.32 11.15 12.32 10.12 11.5L7 9"
            stroke="white"
            stroke-width="1.5"
            stroke-miterlimit="10"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <input
          type="email"
          id="email"
          class="ml-4 text-[15px] bg-transparent focus:outline-none w-full"
          placeholder="Email"
        />
      </div>
    </div>

    <div id="update-button" class="fixed bottom-0 left-0 right-0 p-6">
      <button
        class="w-full bg-[#9D7EFF] text-black py-4 rounded-xl font-medium flex items-center justify-center gap-2 transition-all duration-300 ease-in-out hover:bg-[#9D7EFF]/90 hover:shadow-xl hover:scale-[1.02] relative overflow-hidden group"
      >
        <span
          class="absolute inset-0 bg-white/30 transform -skew-x-12 -translate-x-full group-hover:translate-x-0 transition-transform duration-500"
        ></span>
        GÃ¼ncelle
      </button>
    </div>

    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        const animationElements = [
          document.querySelector("header"),
          document.getElementById("profile"),
          document.getElementById("profile-image"),
          document.getElementById("motion-div"),
          document.getElementById("update-button"),
        ];

        animationElements.forEach((element, index) => {
          element.classList.add("opacity-0", "transform", "translate-y-10");
          setTimeout(() => {
            element.classList.remove("opacity-0", "translate-y-10");
            element.classList.add(
              "transition-all",
              "duration-700",
              "ease-out",
              "opacity-100",
              "translate-y-0"
            );
          }, 300 * (index + 1));
        });

        const elements = {
          fullName: document.getElementById("fullName"),
          phone: document.getElementById("phone"),
          email: document.getElementById("email"),
          avatarImg: document.getElementById("avatar-img"),
          changeAvatarBtn: document.getElementById("change-avatar-btn"),
          avatarInput: document.getElementById("avatar-input"),
          updateButton: document.getElementById("update-button"),
        };

        const defaultValues = {
          fullName: "Berin Doga Alaca",
          phone: "555 555 5555",
          email: "user@gmail.com",
          avatarImg: "../assets/image/avatar.webp",
        };

        const savedData =
          JSON.parse(localStorage.getItem("profileData")) || defaultValues;
        Object.keys(savedData).forEach((key) => {
          if (elements[key]) elements[key].value = savedData[key];
        });

        const validators = {
          fullName: (name) =>
            !name
              ? "Ä°sim alanÄ± zorunludur"
              : name.length < 3
              ? "Ä°sim en az 3 karakter olmalÄ±dÄ±r"
              : null,
          phone: (phone) =>
            !phone
              ? "Telefon numarasÄ± zorunludur"
              : !/^[0-9\s]{11,12}$/.test(phone)
              ? "GeÃ§erli bir telefon numarasÄ± giriniz"
              : null,
          email: (email) =>
            !email
              ? "Email alanÄ± zorunludur"
              : !/^[^\s@]+@[^\s@]+$/.test(email)
              ? "GeÃ§erli bir email adresi giriniz"
              : null,
        };

        const showError = (inputElement, message) => {
          const existingError =
            document.getElementById(`${inputElement.id}-error`) ||
            (() => {
              const errorDiv = document.createElement("div");
              errorDiv.id = `${inputElement.id}-error`;
              errorDiv.className = "text-red-500 text-xs";
              inputElement.parentElement.insertAdjacentElement(
                "afterend",
                errorDiv
              );
              return errorDiv;
            })();

          existingError.textContent = message;
          const motionInputDiv = inputElement.closest('[id="motion-input"]');

          if (motionInputDiv) {
            motionInputDiv.style.border = "2px solid red";
            motionInputDiv.animate(
              [
                { transform: "translateX(-5px)" },
                { transform: "translateX(5px)" },
                { transform: "translateX(-5px)" },
                { transform: "translateX(5px)" },
                { transform: "translateX(0px)" },
              ],
              { duration: 300, easing: "ease-in-out" }
            );
          }
        };

        const removeError = (inputElement) => {
          const errorDiv = document.getElementById(`${inputElement.id}-error`);
          if (errorDiv) errorDiv.remove();

          const motionInputDiv = inputElement.closest('[id="motion-input"]');
          if (motionInputDiv) motionInputDiv.style.border = "none";
        };

        const validateInput = (input) => {
          const error = validators[input.id](input.value);
          error ? showError(input, error) : removeError(input);
        };

        [elements.fullName, elements.phone, elements.email].forEach((input) => {
          input.addEventListener("blur", () => validateInput(input));
        });

        elements.changeAvatarBtn.addEventListener("click", () => {
          elements.avatarInput.click();
        });

        elements.avatarInput.addEventListener("change", (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
              elements.avatarImg.src = event.target.result;
            };
            reader.readAsDataURL(file);
          }
        });

        elements.updateButton.addEventListener("click", () => {
          const inputs = [elements.fullName, elements.phone, elements.email];
          const hasErrors = inputs.some((input) =>
            validators[input.id](input.value)
          );

          if (!hasErrors) {
            const profileData = {
              fullName: elements.fullName.value,
              phone: elements.phone.value,
              email: elements.email.value,
              avatarImg: elements.avatarImg.src,
            };

            localStorage.setItem("profileData", JSON.stringify(profileData));
            alert("Profil bilgileriniz gÃ¼ncellendi!");
          }
        });
      });
    </script>
  </body>
</html>
